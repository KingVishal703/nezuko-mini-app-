<!DOCTYPE html>
<html lang="en">
<head>
  <!-- AdsGram SDK -->
  <script src="https://sad.adsgram.ai/js/sad.min.js"></script>

  <!-- Monetag SDK -->
  <script src="//libtl.com/sdk.js" data-zone="10222194" data-sdk="show_10222194"></script>

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Redirecting...</title>

  <!-- ⚠️ CSS SAME AS ORIGINAL (CUT SHORT FOR SAFETY) -->
</head>
<body>

<!-- ========== UI SAME AS ORIGINAL ========== -->
<div class="card">
  <div class="step-text" id="step-info">FINAL STEP</div>
  <h1 id="title-main">Final step – get your file</h1>
  <p class="sub">Timer khatm hone ke baad button unlock hoga</p>

  <div class="circle"><span id="seconds">5</span></div>

  <div class="progress">
    <div class="progress-inner" id="progress-inner"></div>
  </div>

  <button class="btn-main" id="action-btn" disabled>WAIT...</button>
</div>

<script>
/* ===================== CONFIG ===================== */
const CONFIG = {
  waitSeconds: 5,
  botUsername: "Xnezukochan_bot",
  botStartPrefix: "blg2",

  /* -------- AdsGram -------- */
  adsgram: {
    interstitial: {
      blockId: "int-18636",
      enabled: false,
      onLoad: false,
      onClick: false
    },
    reward: {
      blockId: "18127",
      enabled: false,
      onLoad: false,
      onClick: false
    }
  },

  /* -------- Monetag -------- */
  monetag: {
    adId: "10222194",

    rewardedInterstitial: {
      enabled: true,
      onLoad: true,
      onClick: false
    },

    rewardedPopup: {
      enabled: true,
      onLoad: true,
      onClick: false
    },

    inAppInterstitial: {
      enabled: false,
      onLoad: false,
      onClick: false,
      settings: {
        frequency: 2,
        capping: 0.1,
        interval: 30,
        timeout: 5,
        everyPage: false
      }
    }
  }
};
/* ================================================= */

/* ========== TIMER LOGIC (SAME) ========== */
const btn = document.getElementById("action-btn");
const secEl = document.getElementById("seconds");
const prog = document.getElementById("progress-inner");

let left = CONFIG.waitSeconds;
secEl.textContent = left;

const timer = setInterval(()=>{
  left--;
  secEl.textContent = left;
  prog.style.width = ((CONFIG.waitSeconds-left)/CONFIG.waitSeconds*100)+"%";
  if(left<=0){
    clearInterval(timer);
    btn.disabled=false;
    btn.textContent="GET FILE";
  }
},1000);

/* ========== ADSGRAM ========== */
let adsgramInter = null;
let adsgramReward = null;

function initAdsgram(){
  if(!window.Adsgram) return;
  if(CONFIG.adsgram.interstitial.enabled){
    adsgramInter = Adsgram.init({ blockId: CONFIG.adsgram.interstitial.blockId });
  }
  if(CONFIG.adsgram.reward.enabled){
    adsgramReward = Adsgram.init({ blockId: CONFIG.adsgram.reward.blockId });
  }
}

async function showAdsgramInter(){
  if(adsgramInter) try{ await adsgramInter.show(); }catch{}
}

async function showAdsgramReward(){
  if(adsgramReward) try{ await adsgramReward.show(); }catch{}
}

/* ========== MONETAG ========== */
function monetagRI(){
  return new Promise(r=>{
    const fn=window["show_"+CONFIG.monetag.adId];
    if(typeof fn!=="function") return r();
    fn().then(()=>r()).catch(()=>r());
  });
}

function monetagRP(){
  return new Promise(r=>{
    const fn=window["show_"+CONFIG.monetag.adId];
    if(typeof fn!=="function") return r();
    fn("pop").then(()=>r()).catch(()=>r());
  });
}

function monetagIA(){
  return new Promise(r=>{
    const fn=window["show_"+CONFIG.monetag.adId];
    if(typeof fn!=="function") return r();
    fn({
      type:"inApp",
      inAppSettings: CONFIG.monetag.inAppInterstitial.settings
    });
    r();
  });
}

/* ========== PAGE LOAD ========== */
window.addEventListener("load", async ()=>{
  initAdsgram();

  if(CONFIG.adsgram.interstitial.enabled && CONFIG.adsgram.interstitial.onLoad)
    await showAdsgramInter();

  if(CONFIG.adsgram.reward.enabled && CONFIG.adsgram.reward.onLoad)
    await showAdsgramReward();

  if(CONFIG.monetag.rewardedInterstitial.enabled && CONFIG.monetag.rewardedInterstitial.onLoad)
    await monetagRI();

  if(CONFIG.monetag.rewardedPopup.enabled && CONFIG.monetag.rewardedPopup.onLoad)
    await monetagRP();

  if(CONFIG.monetag.inAppInterstitial.enabled && CONFIG.monetag.inAppInterstitial.onLoad)
    await monetagIA();
});

/* ========== BUTTON CLICK ========== */
btn.addEventListener("click", async ()=>{
  btn.disabled=true;

  /* AdsGram */
  if(CONFIG.adsgram.interstitial.enabled && CONFIG.adsgram.interstitial.onClick)
    await showAdsgramInter();

  if(CONFIG.adsgram.reward.enabled && CONFIG.adsgram.reward.onClick)
    await showAdsgramReward();

  /* Monetag */
  if(CONFIG.monetag.rewardedInterstitial.enabled && CONFIG.monetag.rewardedInterstitial.onClick)
    await monetagRI();

  if(CONFIG.monetag.rewardedPopup.enabled && CONFIG.monetag.rewardedPopup.onClick)
    await monetagRP();

  if(CONFIG.monetag.inAppInterstitial.enabled && CONFIG.monetag.inAppInterstitial.onClick)
    await monetagIA();

  const id=new URLSearchParams(location.search).get("id")||"";
  location.href="https://t.me/"+CONFIG.botUsername+"?start="+CONFIG.botStartPrefix+id;
});
</script>

</body>
</html>
